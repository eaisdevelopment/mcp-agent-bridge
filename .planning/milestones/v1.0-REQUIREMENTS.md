# Requirements Archive: v1.0 MVP

**Archived:** 2026-02-10
**Status:** SHIPPED
**Audit:** PASSED (39/39 requirements satisfied)

---

# Requirements: cc-bridge-mcp-server v1.0

**Defined:** 2026-02-09
**Core Value:** Two Claude Code sessions can exchange messages in real-time while staying fully isolated in their own repos

## v1 Requirements (All Satisfied)

### Testing

- [x] **TEST-01**: All 5 tool handlers have unit tests verifying correct input/output via Vitest
- [x] **TEST-02**: Peer registry service has unit tests covering register, deregister, list, state persistence, and file locking
- [x] **TEST-03**: CLI service has unit tests with mocked `execFile` covering success, timeout, and error paths
- [x] **TEST-04**: Full integration test exercises complete workflow (register -> send -> history -> deregister) via InMemoryTransport
- [x] **TEST-05**: File-based state operations tested with isolated temp directories (no shared /tmp pollution)

### Configuration

- [x] **CONF-01**: Centralized `config.ts` module validates all configuration via Zod and exports typed config object
- [x] **CONF-02**: State file path configurable via `CC_BRIDGE_STATE_PATH` env var, defaults to `~/cloud_code_bridge`
- [x] **CONF-03**: CLI timeout configurable via `CC_BRIDGE_TIMEOUT_MS` env var, defaults to 120000
- [x] **CONF-04**: Character limit configurable via `CC_BRIDGE_CHAR_LIMIT` env var, defaults to 0 (no limit)
- [x] **CONF-05**: Log level configurable via `CC_BRIDGE_LOG_LEVEL` env var (debug/info/warn/error), defaults to info
- [x] **CONF-06**: All logging writes to stderr only; stdout remains clean for MCP stdio transport

### Error Handling

- [x] **ERR-01**: Corrupt state file (invalid JSON) triggers recovery to empty state with stderr warning
- [x] **ERR-02**: Lock acquisition timeout produces clear MCP error response, never crashes process
- [x] **ERR-03**: CLI subprocess failure (exit code, stderr, timeout) produces structured error in MCP response
- [x] **ERR-04**: Missing `claude` CLI binary detected at startup with clear error message
- [x] **ERR-05**: All async operations have timeout guards; no unhandled promise rejections

### Health Check

- [x] **HLTH-01**: `cc_health_check` tool verifies state file is readable and writable
- [x] **HLTH-02**: `cc_health_check` tool verifies lock mechanism works (acquire/release cycle)
- [x] **HLTH-03**: `cc_health_check` tool verifies `claude` CLI is on PATH and executable

### Stale Peer Detection

- [x] **PEER-01**: `cc_list_peers` flags peers whose sessions may be stale
- [x] **PEER-02**: Stale detection uses TTL-based check (CC_BRIDGE_STALE_TIMEOUT_MS, default 30min)

### Package Hygiene

- [x] **PKG-01**: `package.json` has `bin` field pointing to `dist/index.js`
- [x] **PKG-02**: `src/index.ts` has `#!/usr/bin/env node` shebang line
- [x] **PKG-03**: `package.json` has `files` field restricting published content to `["dist", "README.md", "LICENSE", "server.json"]`
- [x] **PKG-04**: `package.json` has `prepublishOnly` script running `npm run build`
- [x] **PKG-05**: LICENSE file exists with ISC license text
- [x] **PKG-06**: `.gitignore` excludes `dist/`, `node_modules/`, `.idea/`, and build artifacts
- [x] **PKG-07**: `package.json` has `keywords` for npm discoverability
- [x] **PKG-08**: `package.json` has `repository`, `homepage`, and `bugs` fields
- [x] **PKG-09**: Version set to `0.1.0` and single-sourced from `package.json`
- [x] **PKG-10**: All 6 tools have correct MCP tool annotations (readOnlyHint, destructiveHint, etc.)

### Documentation

- [x] **DOC-01**: README restructured with npx-first installation instructions
- [x] **DOC-02**: README includes `.mcp.json` configuration example using npx
- [x] **DOC-03**: README includes troubleshooting section (NVM/PATH issues, state file location, common errors)
- [x] **DOC-04**: README documents all `CC_BRIDGE_*` environment variables
- [x] **DOC-05**: README documents the `cc_health_check` tool

### MCP Registry

- [x] **REG-01**: `server.json` metadata file created per MCP Registry spec
- [x] **REG-02**: npm package published (0.1.0) and verified
- [x] **REG-03**: MCP Registry submission completed (io.github.eaisdevelopment)

## Deferred to v2

### CI/CD
- **CI-01**: GitHub Actions workflow runs lint + test + build on every PR
- **CI-02**: Status badge in README
- **CI-03**: Windows CI testing for cross-platform validation

### Community
- **COM-01**: CHANGELOG.md following Keep a Changelog format
- **COM-02**: CONTRIBUTING.md with dev setup, testing, and PR process
- **COM-03**: MCP Inspector compatibility documentation in README

### Enhanced Features
- **ENH-01**: Configurable log output format (JSON vs text)
- **ENH-02**: Multi-peer broadcast messaging

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| TEST-01 | Phase 2 | Satisfied |
| TEST-02 | Phase 2 | Satisfied |
| TEST-03 | Phase 2 | Satisfied |
| TEST-04 | Phase 2 | Satisfied |
| TEST-05 | Phase 2 | Satisfied |
| CONF-01 | Phase 1 | Satisfied |
| CONF-02 | Phase 1 | Satisfied |
| CONF-03 | Phase 1 | Satisfied |
| CONF-04 | Phase 1 | Satisfied |
| CONF-05 | Phase 1 | Satisfied |
| CONF-06 | Phase 1 | Satisfied |
| ERR-01 | Phase 1 | Satisfied |
| ERR-02 | Phase 1 | Satisfied |
| ERR-03 | Phase 1 | Satisfied |
| ERR-04 | Phase 1 | Satisfied |
| ERR-05 | Phase 1 | Satisfied |
| HLTH-01 | Phase 3 | Satisfied |
| HLTH-02 | Phase 3 | Satisfied |
| HLTH-03 | Phase 3 | Satisfied |
| PEER-01 | Phase 3 | Satisfied |
| PEER-02 | Phase 3 | Satisfied |
| PKG-01 | Phase 4 | Satisfied |
| PKG-02 | Phase 4 | Satisfied |
| PKG-03 | Phase 4 | Satisfied |
| PKG-04 | Phase 4 | Satisfied |
| PKG-05 | Phase 4 | Satisfied |
| PKG-06 | Phase 4 | Satisfied |
| PKG-07 | Phase 4 | Satisfied |
| PKG-08 | Phase 4 | Satisfied |
| PKG-09 | Phase 4 | Satisfied |
| PKG-10 | Phase 4 | Satisfied |
| DOC-01 | Phase 5 | Satisfied |
| DOC-02 | Phase 5 | Satisfied |
| DOC-03 | Phase 5 | Satisfied |
| DOC-04 | Phase 5 | Satisfied |
| DOC-05 | Phase 5 | Satisfied |
| REG-01 | Phase 5 | Satisfied |
| REG-02 | Phase 5 | Satisfied |
| REG-03 | Phase 5 | Satisfied |

**Coverage:** 39/39 requirements satisfied (100%)

---
*Requirements defined: 2026-02-09*
*Archived: 2026-02-10 after v1.0 MVP shipped*
