---
phase: 04-package-hygiene
plan: 02
type: execute
wave: 2
depends_on: ["04-01"]
files_modified:
  - LICENSE
  - .gitignore
autonomous: true

must_haves:
  truths:
    - "LICENSE file exists with ISC license text"
    - ".gitignore excludes dist/, node_modules/, .idea/, coverage/, and lock files"
    - "npm pack --dry-run shows only dist/, README.md, LICENSE, and package.json in the tarball"
    - "All 6 MCP tools have correct annotations (readOnlyHint, destructiveHint, idempotentHint, openWorldHint)"
    - "npx-style invocation works: node dist/index.js starts the MCP server"
  artifacts:
    - path: "LICENSE"
      provides: "ISC license text"
      contains: "ISC License"
    - path: ".gitignore"
      provides: "Git ignore rules"
      contains: "dist/"
  key_links:
    - from: "package.json files"
      to: "npm pack output"
      via: "files whitelist controls tarball contents"
      pattern: "\"files\""
    - from: "package.json bin"
      to: "dist/index.js shebang"
      via: "bin entry requires executable with shebang"
      pattern: "#!/usr/bin/env node"
---

<objective>
Create LICENSE and .gitignore files, then verify the complete package hygiene: tarball contents, MCP tool annotations, and CLI executability.

Purpose: Complete the file hygiene requirements and validate that the full package is ready for npm publish.
Output: LICENSE file, .gitignore file, verification that all PKG requirements are satisfied.
</objective>

<execution_context>
@/Users/dev/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dev/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-package-hygiene/04-RESEARCH.md
@.planning/phases/04-package-hygiene/04-01-SUMMARY.md

@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create LICENSE and .gitignore files</name>
  <files>LICENSE, .gitignore</files>
  <action>
Create LICENSE file at project root with ISC license text (PKG-05):

```
ISC License

Copyright (c) 2025 cc-bridge-mcp-server contributors

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
```

Create .gitignore file at project root (PKG-06):

```
# Build output
dist/

# Dependencies
node_modules/

# IDE
.idea/

# Lock files (regenerated on install)
package-lock.json

# Coverage
coverage/

# OS files
.DS_Store

# Environment
.env
.env.local
```
  </action>
  <verify>
Run: `test -f LICENSE && echo "LICENSE exists" || echo "MISSING"`
Run: `test -f .gitignore && echo ".gitignore exists" || echo "MISSING"`
Run: `head -1 LICENSE` -- must show "ISC License"
Run: `grep -c 'dist/' .gitignore` -- must be at least 1
Run: `grep -c 'node_modules/' .gitignore` -- must be at least 1
Run: `grep -c '.idea/' .gitignore` -- must be at least 1
Run: `grep -c 'package-lock.json' .gitignore` -- must be at least 1
  </verify>
  <done>LICENSE exists with ISC text. .gitignore exists excluding dist/, node_modules/, .idea/, package-lock.json, coverage/, .DS_Store, and .env files.</done>
</task>

<task type="auto">
  <name>Task 2: Verify complete package hygiene (tarball, annotations, CLI)</name>
  <files></files>
  <action>
This is a verification-only task. No files are modified. Run all checks to confirm the full phase is complete.

1. **Tarball verification (PKG-01, PKG-03):**
   Run `npm pack --dry-run 2>&1` and verify:
   - Total files should be approximately 25-35 (only dist/ contents + README.md + LICENSE + package.json)
   - No src/, .idea/, .planning/, coverage/, test files, vitest.config.ts, or tsconfig.json in output
   - dist/index.js is included
   - LICENSE is included
   - README.md is included

2. **MCP tool annotations verification (PKG-10):**
   Research confirmed all 6 tools already have correct annotations. Verify by grepping source files:
   - `grep -r "readOnlyHint" src/tools/` should show all 6 tools
   - `grep -r "destructiveHint" src/tools/` should show all 6 tools
   Specifically verify:
   - cc_register_peer: readOnly=false, destructive=false, idempotent=true, openWorld=false
   - cc_deregister_peer: readOnly=false, destructive=true, idempotent=true, openWorld=false
   - cc_send_message: readOnly=false, destructive=false, idempotent=false, openWorld=true
   - cc_list_peers: readOnly=true, destructive=false, idempotent=true, openWorld=false
   - cc_get_history: readOnly=true, destructive=false, idempotent=true, openWorld=false
   - cc_health_check: readOnly=true, destructive=false, idempotent=true, openWorld=false

3. **CLI executability test:**
   Run `node dist/index.js` with a timeout (it will hang waiting for stdin since it is an MCP stdio server). Verify it starts without error by checking stderr output contains the startup banner. Use a short timeout:
   `timeout 3 node dist/index.js 2>&1 || true` -- should show startup banner on stderr before timeout kills it.

4. **Version consistency:**
   Run `node -e "import('./dist/constants.js').then(m => console.log(m.SERVER_VERSION))"` -- must print `0.1.0`
   Run `node -e "console.log(require('./package.json').version)"` -- must print `0.1.0`

5. **Test suite still passes:**
   Run `npm test` -- all tests must pass.

If any check fails, fix the issue before completing.
  </action>
  <verify>
Run: `npm pack --dry-run 2>&1 | grep 'total files'` -- should show approximately 25-35 files (not 173)
Run: `npm pack --dry-run 2>&1 | grep -c 'src/'` -- must be 0
Run: `npm pack --dry-run 2>&1 | grep -c '.idea/'` -- must be 0
Run: `npm pack --dry-run 2>&1 | grep 'LICENSE'` -- must show LICENSE
Run: `npm test` -- all tests pass
  </verify>
  <done>npm pack --dry-run shows only dist/, README.md, LICENSE, and package.json (no source, tests, IDE, or planning files). All 6 tools have correct MCP annotations. CLI starts successfully. Version is consistently 0.1.0. All tests pass.</done>
</task>

</tasks>

<verification>
Phase 4 success criteria from ROADMAP.md:
1. `npm pack --dry-run` shows only dist/, README.md, and LICENSE in the tarball -- VERIFIED
2. `npx cc-bridge-mcp-server` in a clean environment starts the MCP server -- VERIFIED via node dist/index.js test
3. All 6 tools have correct MCP tool annotations -- VERIFIED via grep
4. package.json contains bin, files, prepublishOnly, keywords, repository, homepage, bugs and version 0.1.0 -- VERIFIED
5. LICENSE exists with ISC text, .gitignore excludes dist/, node_modules/, .idea/, and lock files -- VERIFIED
</verification>

<success_criteria>
- LICENSE file exists with ISC license text and "cc-bridge-mcp-server contributors" copyright
- .gitignore excludes dist/, node_modules/, .idea/, package-lock.json, coverage/
- npm pack --dry-run shows ~25-35 files (not 173), only dist/ + README.md + LICENSE + package.json
- All 6 MCP tools have correct readOnlyHint/destructiveHint/idempotentHint/openWorldHint annotations
- node dist/index.js starts without error
- npm test passes
- Version is 0.1.0 everywhere
</success_criteria>

<output>
After completion, create `.planning/phases/04-package-hygiene/04-02-SUMMARY.md`
</output>
